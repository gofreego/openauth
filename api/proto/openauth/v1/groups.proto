syntax = "proto3";
package v1;

option go_package = "./openauth_v1";

// Group represents a group/role in the system for organizing users and permissions
message Group {
    // Unique identifier for the group
    int64 id = 1;
    
    // Unique name for the group
    string name = 2;
    
    // Human-readable display name for the group
    string display_name = 3;

    // Optional detailed description of the group
    optional string description = 4;

    int64 created_by = 5;

    // Timestamp when the group was created
    int64 created_at = 6;

    // Timestamp when the group was last updated
    int64 updated_at = 7;
}

// CreateGroupRequest to create a new group
message CreateGroupRequest {
    // Unique name for the group
    string name = 1;
    
    // Human-readable display name for the group
    string display_name = 2;
    
    // Optional detailed description of the group
    optional string description = 3;
}

// CreateGroupResponse after successful group creation
message CreateGroupResponse {
    Group group = 1;
    string message = 2;
}

// GetGroupRequest to get group by ID
message GetGroupRequest {
    int64 id = 1;
}

// GetGroupResponse
message GetGroupResponse {
    Group group = 1;
}

// UpdateGroupRequest to update group information
message UpdateGroupRequest {
    int64 id = 1;

    // Optional new name for the group
    optional string new_name = 4;
    
    // Optional new display name
    optional string display_name = 5;
    
    // Optional new description
    optional string description = 6;
}

// UpdateGroupResponse
message UpdateGroupResponse {
    Group group = 1;
    string message = 2;
}

// DeleteGroupRequest to delete a group
message DeleteGroupRequest {
    int64 id = 1;
}

// DeleteGroupResponse
message DeleteGroupResponse {
    bool success = 1;
    string message = 2;
}

// ListGroupsRequest for listing groups with pagination and filtering
message ListGroupsRequest {
    // Maximum number of groups to return (default: 10, max: 100)
    int32 limit = 1;
    
    // Number of groups to skip (for pagination)
    int32 offset = 2;

    optional int64 id = 3;

    // Optional search query (searches name, display_name, description)
    optional string search = 4;
}

// ListGroupsResponse
message ListGroupsResponse {
    repeated Group groups = 1;
}

// AssignUserToGroupRequest to add a user to a group
message AssignUserToGroupRequest {
    int64 user_id = 1;
    int64 group_id = 2;
    // Optional expiration time for the group membership
    optional int64 expires_at = 3;
}

// AssignUserToGroupResponse
message AssignUserToGroupResponse {
    bool success = 1;
    string message = 2;
}

// RemoveUserFromGroupRequest to remove a user from a group
message RemoveUserFromGroupRequest {
    int64 user_id = 1;
    int64 group_id = 2;
}

// RemoveUserFromGroupResponse
message RemoveUserFromGroupResponse {
    bool success = 1;
    string message = 2;
}

// ListGroupUsersRequest to get all users in a group
message ListGroupUsersRequest {
    int64 group_id = 1;
    // Pagination
    int32 limit = 2;
    int32 offset = 3;
}

// ListGroupUsersResponse
message ListGroupUsersResponse {
    repeated GroupUser users = 1;
}

// GroupUser represents a user's membership in a group
message GroupUser {
    int64 user_id = 1;
    string user_uuid = 2;
    string username = 3;
    optional string email = 4;
    optional string name = 5;
    optional string avatar = 6;
    optional int64 expires_at = 7;
    int64 assigned_at = 8;
    int64 assigned_by = 9;
}

// ListUserGroupsRequest to get all groups for a user
message ListUserGroupsRequest {
    int64 user_id = 1;
    // Pagination
    int32 limit = 2;
    int32 offset = 3;
}

// ListUserGroupsResponse
message ListUserGroupsResponse {
    repeated UserGroup groups = 1;
}

// UserGroup represents a group membership for a user
message UserGroup {
    int64 group_id = 1;
    string group_name = 2;
    string group_display_name = 3;
    optional string group_description = 4;
    bool is_system = 5;
    bool is_default = 6;
    optional int64 expires_at = 7;
    int64 assigned_at = 8;
    int64 assigned_by = 9;
}
